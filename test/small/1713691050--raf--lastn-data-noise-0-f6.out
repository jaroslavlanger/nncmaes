(3_w,6)-aCMA-ES (mu_w=2.0,w_1=63%) in dimension 2 (seed=1, Sun Apr 21 10:56:01 2024)
subset-idx-size=6

NN: 0
epoch: 200 , mse_ 0.029 , loss_anch 0.029 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.775 , loss_anch 0.775 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 0.09 , loss_anch 0.09 tau-train= 1.00
epoch: 400 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=0.9999999999999999
tau-archive=0.9999999999999999
eval=1 | not-eval=5 | tau= 1.00 | n_kendall= 7 | std(means)/mean(stds)=  1.52 | std(means)=1.70e+05 | mean(stds)=1.11e+05
tau-population= 0.73
subset-idx-size=7

NN: 0
epoch: 200 , mse_ 0.055 , loss_anch 0.055 tau-train= 1.00
epoch: 400 , mse_ 0.026 , loss_anch 0.026 tau-train= 1.00
epoch: 600 , mse_ 0.012 , loss_anch 0.012 tau-train= 1.00
epoch: 800 , mse_ 0.005 , loss_anch 0.005 tau-train= 1.00
epoch: 1000 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.123 , loss_anch 0.123 tau-train= 1.00
epoch: 400 , mse_ 0.02 , loss_anch 0.02 tau-train= 1.00
epoch: 600 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 0.127 , loss_anch 0.127 tau-train= 1.00
epoch: 400 , mse_ 0.078 , loss_anch 0.078 tau-train= 1.00
epoch: 600 , mse_ 0.038 , loss_anch 0.038 tau-train= 1.00
epoch: 800 , mse_ 0.015 , loss_anch 0.015 tau-train= 1.00
epoch: 1000 , mse_ 0.004 , loss_anch 0.004 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=0.9999999999999999
eval=1 | not-eval=5 | tau= 0.93 | n_kendall= 8 | std(means)/mean(stds)=  0.71 | std(means)=1.05e+05 | mean(stds)=1.48e+05
tau-population= 0.07
subset-idx-size=8

NN: 0
epoch: 200 , mse_ 1.999 , loss_anch 1.999 tau-train= 0.86
epoch: 400 , mse_ 0.186 , loss_anch 0.186 tau-train= 1.00
epoch: 600 , mse_ 0.077 , loss_anch 0.077 tau-train= 1.00
epoch: 800 , mse_ 0.042 , loss_anch 0.042 tau-train= 1.00
epoch: 1000 , mse_ 0.023 , loss_anch 0.023 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 0.193 , loss_anch 0.193 tau-train= 0.86
epoch: 400 , mse_ 0.033 , loss_anch 0.033 tau-train= 1.00
epoch: 600 , mse_ 0.003 , loss_anch 0.003 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.004 , loss_anch 0.004 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.065 , loss_anch 0.065 tau-train= 0.93
epoch: 400 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=0.9999999999999998
tau-archive=1.0
eval=1 | not-eval=5 | tau= 0.89 | n_kendall= 9 | std(means)/mean(stds)=  1.10 | std(means)=1.06e+05 | mean(stds)=9.62e+04
tau-population= 0.73
subset-idx-size=9

NN: 0
epoch: 200 , mse_ 1.454 , loss_anch 1.454 tau-train= 0.94
epoch: 400 , mse_ 0.152 , loss_anch 0.152 tau-train= 0.94
epoch: 600 , mse_ 0.006 , loss_anch 0.006 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.025 , loss_anch 0.025 tau-train= 0.94
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 8.921 , loss_anch 8.921 tau-train= 0.94
epoch: 400 , mse_ 1.142 , loss_anch 1.142 tau-train= 0.83
epoch: 600 , mse_ 0.183 , loss_anch 0.183 tau-train= 1.00
epoch: 800 , mse_ 0.014 , loss_anch 0.014 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.285 , loss_anch 0.285 tau-train= 0.89
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 10.277 , loss_anch 10.277 tau-train= 0.89
epoch: 400 , mse_ 0.051 , loss_anch 0.051 tau-train= 0.94
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=0.9999999999999998
eval=1 | not-eval=5 | tau= 0.87 | n_kendall=10 | std(means)/mean(stds)=  0.58 | std(means)=3.16e+04 | mean(stds)=5.42e+04
tau-population=-0.07
subset-idx-size=10

NN: 0
epoch: 200 , mse_ 0.963 , loss_anch 0.963 tau-train= 0.96
epoch: 400 , mse_ 0.163 , loss_anch 0.163 tau-train= 1.00
epoch: 600 , mse_ 0.087 , loss_anch 0.087 tau-train= 0.78
epoch: 800 , mse_ 0.048 , loss_anch 0.048 tau-train= 1.00
epoch: 1000 , mse_ 88.69 , loss_anch 88.69 tau-train= 0.73

NN: 1
epoch: 200 , mse_ 0.244 , loss_anch 0.244 tau-train= 0.91
epoch: 400 , mse_ 0.006 , loss_anch 0.006 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 0.208 , loss_anch 0.208 tau-train= 0.96
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.027 , loss_anch 0.027 tau-train= 0.96
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.49 , loss_anch 0.49 tau-train= 0.96
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=0.8666666666666666
tau-archive=0.8333333333333334
eval=6 | not-eval=0 | tau= 0.42 | n_kendall=12 | std(means)/mean(stds)=  1.10 | std(means)=1.24e+05 | mean(stds)=1.12e+05
tau-population= 0.20
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 50.75 , loss_anch 50.75 tau-train= 0.82
epoch: 400 , mse_ 38.094 , loss_anch 38.094 tau-train= 0.85
epoch: 600 , mse_ 27.247 , loss_anch 27.247 tau-train= 0.89
epoch: 800 , mse_ 13.533 , loss_anch 13.533 tau-train= 0.93
epoch: 1000 , mse_ 5.232 , loss_anch 5.232 tau-train= 0.89

NN: 1
epoch: 200 , mse_ 7.674 , loss_anch 7.674 tau-train= 0.89
epoch: 400 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 5.934 , loss_anch 5.934 tau-train= 0.85
epoch: 400 , mse_ 0.059 , loss_anch 0.059 tau-train= 0.89
epoch: 600 , mse_ 0.008 , loss_anch 0.008 tau-train= 0.96
epoch: 800 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 25.609 , loss_anch 25.609 tau-train= 0.93
epoch: 400 , mse_ 0.235 , loss_anch 0.235 tau-train= 0.96
epoch: 600 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.814 , loss_anch 0.814 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=6 | not-eval=0 | tau= 0.60 | n_kendall=12 | std(means)/mean(stds)=  1.35 | std(means)=2.52e+03 | mean(stds)=1.87e+03
tau-population= 0.60
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 42.598 , loss_anch 42.598 tau-train= 0.71
epoch: 400 , mse_ 7.165 , loss_anch 7.165 tau-train= 0.71
epoch: 600 , mse_ 2.494 , loss_anch 2.494 tau-train= 0.71
epoch: 800 , mse_ 1.539 , loss_anch 1.539 tau-train= 0.71
epoch: 1000 , mse_ 17.787 , loss_anch 17.787 tau-train= 0.64

NN: 1
epoch: 200 , mse_ 0.308 , loss_anch 0.308 tau-train= 0.89
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 7.102 , loss_anch 7.102 tau-train= 0.82
epoch: 400 , mse_ 1.25 , loss_anch 1.25 tau-train= 0.82
epoch: 600 , mse_ 0.688 , loss_anch 0.688 tau-train= 0.85
epoch: 800 , mse_ 0.367 , loss_anch 0.367 tau-train= 0.85
epoch: 1000 , mse_ 0.336 , loss_anch 0.336 tau-train= 0.71

NN: 3
epoch: 200 , mse_ 4.353 , loss_anch 4.353 tau-train= 0.67
epoch: 400 , mse_ 0.006 , loss_anch 0.006 tau-train= 0.96
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.056 , loss_anch 0.056 tau-train= 0.96
epoch: 400 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=0.7454545454545454
tau-archive=0.7454545454545454
eval=6 | not-eval=0 | tau= 0.42 | n_kendall=12 | std(means)/mean(stds)=  0.43 | std(means)=1.19e+04 | mean(stds)=2.76e+04
tau-population=-0.07
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 17.489 , loss_anch 17.489 tau-train= 0.71
epoch: 400 , mse_ 3.728 , loss_anch 3.728 tau-train= 0.56
epoch: 600 , mse_ 1.372 , loss_anch 1.372 tau-train= 0.49
epoch: 800 , mse_ 0.517 , loss_anch 0.517 tau-train= 0.45
epoch: 1000 , mse_ 0.185 , loss_anch 0.185 tau-train= 0.53

NN: 1
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.002 , loss_anch 0.002 tau-train= 0.82
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 2.644 , loss_anch 2.644 tau-train= 0.64
epoch: 400 , mse_ 0.305 , loss_anch 0.305 tau-train= 0.49
epoch: 600 , mse_ 2.775 , loss_anch 2.775 tau-train= 0.82
epoch: 800 , mse_ 0.081 , loss_anch 0.081 tau-train= 0.13
epoch: 1000 , mse_ 23.31 , loss_anch 23.31 tau-train= 0.16

NN: 3
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.89
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
> /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1080)__call__()
-> print(f"tau-train-ens={_tau}")
(Pdb) array([[ 3.0577642 ],
       [ 2.54552166],
       [ 1.92482701],
       [-0.18257415],
       [-0.4015245 ],
       [-0.41126146],
       [-0.40815881],
       [-0.40996038],
       [-0.41004953],
       [-0.41015651],
       [-0.41067754],
       [-0.41166139]])
(Pdb) tau-train-ens=0.0909090909090909
tau-archive=0.0909090909090909
eval=6 | not-eval=0 | tau=-0.33 | n_kendall=12 | std(means)/mean(stds)=  2.28 | std(means)=4.55e+04 | mean(stds)=1.99e+04
tau-population=-0.20
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 1.012 , loss_anch 1.012 tau-train= 0.09
epoch: 400 , mse_ 0.004 , loss_anch 0.004 tau-train= 0.75
epoch: 600 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.89
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.96
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 0.002 , loss_anch 0.002 tau-train= 0.75
epoch: 400 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.85
epoch: 600 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.89
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.89
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.89

NN: 3
epoch: 200 , mse_ 0.005 , loss_anch 0.005 tau-train= 0.82
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.96
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=1 | not-eval=5 | tau= 0.97 | n_kendall=12 | std(means)/mean(stds)=  1.71 | std(means)=1.40e+04 | mean(stds)=8.20e+03
tau-population= 0.47
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 5.132 , loss_anch 5.132 tau-train=-0.02
epoch: 400 , mse_ 0.998 , loss_anch 0.998 tau-train= 0.09
epoch: 600 , mse_ 0.564 , loss_anch 0.564 tau-train= 0.13
epoch: 800 , mse_ 0.415 , loss_anch 0.415 tau-train= 0.31
epoch: 1000 , mse_ 0.343 , loss_anch 0.343 tau-train= 0.56

NN: 1
epoch: 200 , mse_ 2.83 , loss_anch 2.83 tau-train= 0.56
epoch: 400 , mse_ 1.579 , loss_anch 1.579 tau-train= 0.64
epoch: 600 , mse_ 0.828 , loss_anch 0.828 tau-train= 0.67
epoch: 800 , mse_ 0.405 , loss_anch 0.405 tau-train= 0.67
epoch: 1000 , mse_ 0.182 , loss_anch 0.182 tau-train= 0.67

NN: 2
epoch: 200 , mse_ 0.412 , loss_anch 0.412 tau-train= 0.27
epoch: 400 , mse_ 0.267 , loss_anch 0.267 tau-train= 0.64
epoch: 600 , mse_ 0.209 , loss_anch 0.209 tau-train= 0.64
epoch: 800 , mse_ 0.153 , loss_anch 0.153 tau-train= 0.60
epoch: 1000 , mse_ 0.104 , loss_anch 0.104 tau-train= 0.64

NN: 3
epoch: 200 , mse_ 0.967 , loss_anch 0.967 tau-train= 0.60
epoch: 400 , mse_ 0.657 , loss_anch 0.657 tau-train= 0.60
epoch: 600 , mse_ 0.421 , loss_anch 0.421 tau-train= 0.60
epoch: 800 , mse_ 0.244 , loss_anch 0.244 tau-train= 0.64
epoch: 1000 , mse_ 0.134 , loss_anch 0.134 tau-train= 0.64

NN: 4
epoch: 200 , mse_ 0.656 , loss_anch 0.656 tau-train= 0.67
epoch: 400 , mse_ 0.303 , loss_anch 0.303 tau-train= 0.67
epoch: 600 , mse_ 0.091 , loss_anch 0.091 tau-train= 0.64
epoch: 800 , mse_ 0.005 , loss_anch 0.005 tau-train= 0.75
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.93
> /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1080)__call__()
-> print(f"tau-train-ens={_tau}")
(Pdb) array([[-0.25958326],
       [-0.25996118],
       [-0.26041471],
       [-0.26262344],
       [-0.26679417],
       [ 3.76623699],
       [-0.25804388],
       [-0.26586161],
       [-0.26668626],
       [-0.26718988],
       [-0.26794295],
       [-0.26788855]])
(Pdb) tau-train-ens=0.6363636363636364
> /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1082)__call__()
-> def raf(features):
(Pdb) > /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1089)__call__()
-> return raf
(Pdb) --Return--
> /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1089)__call__()-><function Raf...x7f0c1c5df4c0>
-> return raf
(Pdb) > /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1427)__call__()
-> model = (
(Pdb) 1398 	    def __call__(
1399 	        self,
1400 	        *,
1401 	        x_train: NDArray[np.float64],
1402 	        y_train: NDArray[np.float64],
1403 	        x_test: NDArray[np.float64],
1404 	        es: Cma,
1405 	    ) -> Model:
1406 	        subset_idx = self.__subset(
1407 	            x_train=x_train, y_train=y_train, x_test=x_test, es=es
1408 	        )
1409 	        subset_idx = np.sort(subset_idx)
1410 	        if __debug__:
1411 	            print(f"subset-idx-size={subset_idx.size}")
1412 	        x_subset, y_subset = x_train[subset_idx], y_train[subset_idx]
1413 	
1414 	        norms = np.array([es.mahalanobis_norm(x) for x in x_subset - es.mean])
1415 	        # TODO: Hansen's 20..1
1416 	        # weights = np.linspace(1, 20, y_train.shape[0])[:, None]
1417 	        weights = np.e ** -norms
1418 	
1419 	        (x_shift, x_scale) = self.__shift_and_scale_x(x_train=x_subset, y_train=y_subset, x_test=x_test, es=es, weights=weights)
1420 	        (y_shift, y_scale) = self.__shift_and_scale_y(x_train=x_subset, y_train=y_subset, x_test=x_test, es=es, weights=weights)
1421 	
1422 	        x_train_scaled = (x_subset - x_shift) / x_scale
1423 	        y_train_scaled = (y_subset - y_shift) / y_scale
1424 	        # breakpoint()
1425 	        x_test_scaled = (x_test - x_shift) / x_scale
1426 	
1427 ->	        model = (
1428 	            self.__model(
1429 	                x_train=x_train_scaled, y_train=y_train_scaled, x_test=x_test_scaled, weights=weights
1430 	            )
1431 	            if isinstance(self.__model, ModelFactory)
1432 	            else self.__model
1433 	        )
1434 	
1435 	        @wraps(model)
1436 	        def surrogate_model(
1437 	            features: np.ndarray[tuple[N, DIM], np.dtype[np.float64]],
1438 	        ) -> Prediction[N]:
1439 	            features_scaled = (features - x_shift) / x_scale
1440 	            pred_scaled = model(features_scaled)
1441 	            pred_mean, pred_std = (
1442 	                pred_scaled.mean * y_scale + y_shift,
1443 	                pred_scaled.std * y_scale,
1444 	            )
1445 	            return Prediction(pred_mean, pred_std)
1446 	
1447 	        return surrogate_model
(Pdb) *** NameError: name 'y_archive' is not defined
(Pdb) 35
(Pdb) > /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1435)__call__()
-> @wraps(model)
(Pdb) > /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1436)__call__()
-> def surrogate_model(
(Pdb) > /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1447)__call__()
-> return surrogate_model
(Pdb) --Return--
> /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1447)__call__()-><function Raf...x7f0c1c5dfb80>
-> return surrogate_model
(Pdb) > /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1768)get_values_and_eval_idx()
-> points=points,
(Pdb) tau-archive=0.6363636363636364
eval=6 | not-eval=0 | tau= 0.38 | n_kendall=12 | std(means)/mean(stds)=  1.66 | std(means)=2.40e+04 | mean(stds)=1.45e+04
tau-population= 0.47
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 18.265 , loss_anch 18.265 tau-train= 0.24
epoch: 400 , mse_ 2.244 , loss_anch 2.244 tau-train= 0.35
epoch: 600 , mse_ 0.344 , loss_anch 0.344 tau-train= 0.38
epoch: 800 , mse_ 0.108 , loss_anch 0.108 tau-train= 0.38
epoch: 1000 , mse_ 0.076 , loss_anch 0.076 tau-train= 0.49

NN: 1
epoch: 200 , mse_ 0.008 , loss_anch 0.008 tau-train= 0.71
epoch: 400 , mse_ 0.002 , loss_anch 0.002 tau-train= 0.71
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.82
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.93
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 0.501 , loss_anch 0.501 tau-train= 0.38
epoch: 400 , mse_ 0.072 , loss_anch 0.072 tau-train= 0.42
epoch: 600 , mse_ 0.015 , loss_anch 0.015 tau-train= 0.49
epoch: 800 , mse_ 0.008 , loss_anch 0.008 tau-train= 0.71
epoch: 1000 , mse_ 0.006 , loss_anch 0.006 tau-train= 0.71

NN: 3
epoch: 200 , mse_ 1.207 , loss_anch 1.207 tau-train= 0.38
epoch: 400 , mse_ 0.271 , loss_anch 0.271 tau-train= 0.67
epoch: 600 , mse_ 0.067 , loss_anch 0.067 tau-train= 0.67
epoch: 800 , mse_ 0.01 , loss_anch 0.01 tau-train= 0.67
epoch: 1000 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.78

NN: 4
epoch: 200 , mse_ 0.098 , loss_anch 0.098 tau-train= 0.42
epoch: 400 , mse_ 0.015 , loss_anch 0.015 tau-train= 0.64
epoch: 600 , mse_ 0.003 , loss_anch 0.003 tau-train= 0.71
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.82
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.96
tau-train-ens=0.7090909090909091
tau-archive=0.7090909090909091
eval=6 | not-eval=0 | tau= 0.42 | n_kendall=12 | std(means)/mean(stds)=  2.47 | std(means)=2.58e+04 | mean(stds)=1.04e+04
tau-population= 0.33
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 5.232 , loss_anch 5.232 tau-train= 0.49
epoch: 400 , mse_ 0.201 , loss_anch 0.201 tau-train= 0.64
epoch: 600 , mse_ 0.039 , loss_anch 0.039 tau-train= 0.85
epoch: 800 , mse_ 0.706 , loss_anch 0.706 tau-train= 0.13
epoch: 1000 , mse_ 0.003 , loss_anch 0.003 tau-train= 0.89

NN: 1
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 1.119 , loss_anch 1.119 tau-train= 0.64
epoch: 400 , mse_ 0.041 , loss_anch 0.041 tau-train= 0.82
epoch: 600 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.89
epoch: 800 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.96
epoch: 1000 , mse_ 0.238 , loss_anch 0.238 tau-train= 0.38

NN: 3
epoch: 200 , mse_ 0.579 , loss_anch 0.579 tau-train= 0.67
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.96
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=0.8181818181818182
tau-archive=0.8181818181818182
eval=6 | not-eval=0 | tau= 0.29 | n_kendall=12 | std(means)/mean(stds)=  2.05 | std(means)=2.60e+04 | mean(stds)=1.27e+04
tau-population= 0.60
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 153.772 , loss_anch 153.772 tau-train= 0.56
epoch: 400 , mse_ 6.159 , loss_anch 6.159 tau-train= 0.60
epoch: 600 , mse_ 0.549 , loss_anch 0.549 tau-train= 0.60
epoch: 800 , mse_ 0.235 , loss_anch 0.235 tau-train= 0.67
epoch: 1000 , mse_ 0.1 , loss_anch 0.1 tau-train= 0.85

NN: 1
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.89
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 70.294 , loss_anch 70.294 tau-train= 0.64
epoch: 400 , mse_ 1.898 , loss_anch 1.898 tau-train= 0.82
epoch: 600 , mse_ 0.163 , loss_anch 0.163 tau-train= 0.82
epoch: 800 , mse_ 0.012 , loss_anch 0.012 tau-train= 0.85
epoch: 1000 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.93

NN: 3
epoch: 200 , mse_ 0.5 , loss_anch 0.5 tau-train= 0.53
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.93
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.89
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=0.8909090909090909
tau-archive=0.8909090909090909
eval=6 | not-eval=0 | tau= 0.47 | n_kendall=12 | std(means)/mean(stds)=  0.49 | std(means)=2.47e+03 | mean(stds)=5.05e+03
tau-population= 0.87
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 6.827 , loss_anch 6.827 tau-train= 0.09
epoch: 400 , mse_ 1.254 , loss_anch 1.254 tau-train= 0.38
epoch: 600 , mse_ 0.153 , loss_anch 0.153 tau-train= 0.49
epoch: 800 , mse_ 0.02 , loss_anch 0.02 tau-train= 0.60
epoch: 1000 , mse_ 0.005 , loss_anch 0.005 tau-train= 0.64

NN: 1
epoch: 200 , mse_ 2.863 , loss_anch 2.863 tau-train= 0.09
epoch: 400 , mse_ 0.006 , loss_anch 0.006 tau-train= 0.67
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 27.636 , loss_anch 27.636 tau-train= 0.13
epoch: 400 , mse_ 8.652 , loss_anch 8.652 tau-train= 0.09
epoch: 600 , mse_ 2.284 , loss_anch 2.284 tau-train= 0.20
epoch: 800 , mse_ 0.699 , loss_anch 0.699 tau-train= 0.42
epoch: 1000 , mse_ 0.239 , loss_anch 0.239 tau-train= 0.53

NN: 3
epoch: 200 , mse_ 7.415 , loss_anch 7.415 tau-train= 0.35
epoch: 400 , mse_ 0.202 , loss_anch 0.202 tau-train= 0.78
epoch: 600 , mse_ 0.003 , loss_anch 0.003 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.251 , loss_anch 0.251 tau-train= 0.45
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
> /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1080)__call__()
-> print(f"tau-train-ens={_tau}")
(Pdb) 0.6363636363636364
(Pdb) 979  	    def __call__(
980  	        self,
981  	        *,
982  	        x_train: NDArray[np.float64],
983  	        y_train: NDArray[np.float64],
984  	        x_test: NDArray[np.float64],
985  	        weights: NDArray[np.float64],
986  	    ):
987  	        data_noise = self.__data_noise
988  	        """Taken form `RAFs <https://github.com/YanasGH/RAFs/blob/6a0ec46a7d9cd830e7d8e74358643aee1f65323d/main_experiments/rafs.py#L94-L157>`_"""
989  	        X_train, y_train, X_val = x_train, y_train, x_test
990  	
991  	        n = X_train.shape[0]
992  	        x_dim = X_train.shape[1]
993  	        y_dim = y_train.shape[1]
994  	        if __debug__:
995  	            _max_model_size = max(x_test.shape[0], x_dim * (x_dim + 3) + 2)  # for kendall only
996  	            _n_kendall_archive = _max_model_size - 1
997  	
998  	        n_ensembles = 5
999  	        hidden_size = 100
1000 	        init_stddev_1_w = np.sqrt(10)
1001 	        init_stddev_1_b = init_stddev_1_w  # set these equal
1002 	        init_stddev_2_w = 1.0 / np.sqrt(hidden_size)  # normal scaling
1003 	        lambda_anchor = data_noise / (
1004 	            np.array([init_stddev_1_w, init_stddev_1_b, init_stddev_2_w]) ** 2
1005 	        )
1006 	
1007 	        n_epochs = self.__epochs
1008 	        learning_rate = 0.01
1009 	
1010 	        NNs = []
1011 	        y_prior = []
1012 	        tf.reset_default_graph()
1013 	        sess = tf.Session()
1014 	
1015 	        # loop to initialise all ensemble members, get priors
1016 	        for ens in range(0, n_ensembles):
1017 	            NNs.append(
1018 	                NN(
1019 	                    x_dim,
1020 	                    y_dim,
1021 	                    hidden_size,
1022 	                    init_stddev_1_w,
1023 	                    init_stddev_1_b,
1024 	                    init_stddev_2_w,
1025 	                    n,
1026 	                    learning_rate,
1027 	                    ens,
1028 	                )
1029 	            )
1030 	
1031 	            # initialise only unitialized variables - stops overwriting ensembles already created
1032 	            global_vars = tf.global_variables()
1033 	            is_not_initialized = sess.run(
1034 	                [tf.is_variable_initialized(var) for var in global_vars]
1035 	            )
1036 	            not_initialized_vars = [
1037 	                v for (v, f) in zip(global_vars, is_not_initialized) if not f
1038 	            ]
1039 	            if len(not_initialized_vars):
1040 	                sess.run(tf.variables_initializer(not_initialized_vars))
1041 	
1042 	            # do regularisation now that we've created initialisations
1043 	            NNs[ens].anchor(
1044 	                sess, lambda_anchor
1045 	            )  # Do that if you want to minimize the anchored loss
1046 	
1047 	            # save their priors
1048 	            y_prior.append(NNs[ens].predict(X_val, sess))
1049 	
1050 	        for ens in range(0, n_ensembles):
1051 	            feed_b = {}
1052 	            feed_b[NNs[ens].inputs] = X_train
1053 	            feed_b[NNs[ens].y_target] = y_train
1054 	            if __debug__ and self.__debug:
1055 	                print("\nNN:", ens)
1056 	
1057 	            ep_ = 0
1058 	            while ep_ < n_epochs:
1059 	                ep_ += 1
1060 	                blank = sess.run(NNs[ens].optimizer, feed_dict=feed_b)  # noqa: F841
1061 	                if ep_ % (n_epochs / 5) == 0:
1062 	                    loss_mse = sess.run(NNs[ens].mse_, feed_dict=feed_b)
1063 	                    loss_anch = sess.run(NNs[ens].loss_, feed_dict=feed_b)
1064 	                    if __debug__ and self.__debug:
1065 	                        print(
1066 	                            "epoch:",
1067 	                            ep_,
1068 	                            ", mse_",
1069 	                            np.round(loss_mse * 1e3, 3),
1070 	                            ", loss_anch",
1071 	                            np.round(loss_anch * 1e3, 3),
1072 	                            "tau-train={:>5.2f}".format(kendalltau(y_train[-_n_kendall_archive:], np.array(NNs[ens].predict(X_train[-_n_kendall_archive:], sess))).statistic),  # pyright: ignore [reportOperatorIssue,reportPossiblyUnboundVariable]
1073 	                            )
1074 	                    # the anchored loss is minimized, but it's useful to keep an eye on mse too
1075 	
1076 	        if __debug__ and self.__debug:
1077 	            _tau = kendalltau(y_train[-_n_kendall_archive:], np.mean(np.array([nn.predict(X_train[-_n_kendall_archive:], sess) for nn in NNs]), axis=0)).statistic  # pyright: ignore [reportOperatorIssue,reportPossiblyUnboundVariable]
1078 	            if _tau < 0.7:
1079 	                breakpoint()
1080 ->	            print(f"tau-train-ens={_tau}")
1081 	
1082 	        def raf(features):
1083 	            y_pred = np.array([nn.predict(features, sess) for nn in NNs])
1084 	            return Prediction(
1085 	                np.mean(y_pred, axis=0),
1086 	                np.sqrt(np.square(np.std(y_pred, axis=0, ddof=1)) + data_noise),
1087 	            )
1088 	
1089 	        return raf
(Pdb) <__main__.NN object at 0x7f0bdee1cdf0>
(Pdb) array([[ 0.17061285],
       [-0.00546764],
       [-0.05101728],
       [-0.06441241],
       [-0.06612942],
       [-0.06292968],
       [-0.06287002],
       [-0.05891046],
       [-0.06922808],
       [-0.06745209],
       [-0.06477508]])
(Pdb) array([[ 3.92270457e-04],
       [-5.57174658e-04],
       [-1.09928493e-04],
       [-1.09707238e-03],
       [ 1.37714554e-04],
       [ 5.81609743e-04],
       [ 5.72025555e-05],
       [-5.54468781e-03],
       [ 4.51263850e-03],
       [ 2.48722451e-03],
       [-9.05736176e-04]])
(Pdb) (12, 1)
(Pdb) array([[ 0.17100512],
       [-0.00602482],
       [-0.05112721],
       [-0.06550948],
       [-0.06599171],
       [-0.06234807],
       [-0.06281282],
       [-0.06445514],
       [-0.06471544],
       [-0.06496486],
       [-0.06568082]])
(Pdb) (11, 1)
(Pdb) array([[ 1.95080290e+01],
       [ 1.71005121e-01],
       [-6.02481589e-03],
       [-5.11272100e-02],
       [-6.55094828e-02],
       [-6.59917057e-02],
       [-6.23480707e-02],
       [-6.28128161e-02],
       [-6.44551431e-02],
       [-6.47154410e-02],
       [-6.49648624e-02],
       [-6.56808208e-02]])
(Pdb) array([[ 3.83576473e-05],
       [ 3.92270457e-04],
       [-5.57174658e-04],
       [-1.09928493e-04],
       [-1.09707238e-03],
       [ 1.37714554e-04],
       [ 5.81609743e-04],
       [ 5.72025555e-05],
       [-5.54468781e-03],
       [ 4.51263850e-03],
       [ 2.48722451e-03],
       [-9.05736176e-04]])
(Pdb) array([[1.47130911e-09],
       [1.53876111e-07],
       [3.10443599e-07],
       [1.20842736e-08],
       [1.20356782e-06],
       [1.89652984e-08],
       [3.38269893e-07],
       [3.27213235e-09],
       [3.07435629e-05],
       [2.03639062e-05],
       [6.18628579e-06],
       [8.20358020e-07]])
(Pdb) array([[-4.39806512, -1.16075743],
       [-1.54065394,  0.52085354],
       [-1.43613946,  0.74153434],
       [ 4.54321899,  2.60822501],
       [ 0.03670264,  0.61757118],
       [-0.42075291,  0.40047294],
       [ 1.60859816,  0.71488094],
       [ 1.42303129,  1.23802249],
       [ 0.50572376,  0.41240852],
       [ 0.34970245,  0.15571766],
       [ 0.25426067,  0.78190175],
       [-0.15660996, -0.36844044]])
(Pdb) tau-train-ens=0.6363636363636364
tau-archive=0.6363636363636364
eval=6 | not-eval=0 | tau=-0.02 | n_kendall=12 | std(means)/mean(stds)=  0.81 | std(means)=8.86e+03 | mean(stds)=1.10e+04
tau-population=-0.20
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 4.359 , loss_anch 4.359 tau-train= 0.89
epoch: 400 , mse_ 1.557 , loss_anch 1.557 tau-train= 0.93
epoch: 600 , mse_ 0.602 , loss_anch 0.602 tau-train= 1.00
epoch: 800 , mse_ 0.299 , loss_anch 0.299 tau-train= 1.00
epoch: 1000 , mse_ 0.169 , loss_anch 0.169 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 1.729 , loss_anch 1.729 tau-train= 0.96
epoch: 400 , mse_ 16.695 , loss_anch 16.695 tau-train= 0.93
epoch: 600 , mse_ 0.016 , loss_anch 0.016 tau-train= 1.00
epoch: 800 , mse_ 0.009 , loss_anch 0.009 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=6 | not-eval=0 | tau= 0.29 | n_kendall=12 | std(means)/mean(stds)=  1.72 | std(means)=4.93e+00 | mean(stds)=2.87e+00
tau-population=-0.07
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 1.535 , loss_anch 1.535 tau-train= 0.13
epoch: 400 , mse_ 0.243 , loss_anch 0.243 tau-train= 0.49
epoch: 600 , mse_ 0.021 , loss_anch 0.021 tau-train= 0.75
epoch: 800 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.93
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 1.135 , loss_anch 1.135 tau-train= 0.27
epoch: 400 , mse_ 0.071 , loss_anch 0.071 tau-train= 0.56
epoch: 600 , mse_ 0.002 , loss_anch 0.002 tau-train= 0.85
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=1 | not-eval=5 | tau= 1.00 | n_kendall=12 | std(means)/mean(stds)=  2.32 | std(means)=1.25e+03 | mean(stds)=5.37e+02
tau-population= 0.60
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 11.334 , loss_anch 11.334 tau-train= 0.05
epoch: 400 , mse_ 0.441 , loss_anch 0.441 tau-train= 0.35
epoch: 600 , mse_ 0.244 , loss_anch 0.244 tau-train= 0.64
epoch: 800 , mse_ 0.176 , loss_anch 0.176 tau-train= 0.67
epoch: 1000 , mse_ 0.117 , loss_anch 0.117 tau-train= 0.67

NN: 1
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.96
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 2.075 , loss_anch 2.075 tau-train= 0.16
epoch: 400 , mse_ 0.425 , loss_anch 0.425 tau-train= 0.56
epoch: 600 , mse_ 0.11 , loss_anch 0.11 tau-train= 0.64
epoch: 800 , mse_ 0.019 , loss_anch 0.019 tau-train= 0.85
epoch: 1000 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.377 , loss_anch 0.377 tau-train= 0.56
epoch: 400 , mse_ 0.037 , loss_anch 0.037 tau-train= 0.78
epoch: 600 , mse_ 0.005 , loss_anch 0.005 tau-train= 0.93
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.96
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.96
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=0.9272727272727274
tau-archive=0.9272727272727274
eval=6 | not-eval=0 | tau=-0.29 | n_kendall=12 | std(means)/mean(stds)=  0.49 | std(means)=1.94e+02 | mean(stds)=3.98e+02
tau-population=-0.33
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 7.066 , loss_anch 7.066 tau-train= 0.96
epoch: 400 , mse_ 1.055 , loss_anch 1.055 tau-train= 1.00
epoch: 600 , mse_ 0.176 , loss_anch 0.176 tau-train= 1.00
epoch: 800 , mse_ 0.032 , loss_anch 0.032 tau-train= 1.00
epoch: 1000 , mse_ 0.01 , loss_anch 0.01 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 2.767 , loss_anch 2.767 tau-train= 0.89
epoch: 400 , mse_ 0.017 , loss_anch 0.017 tau-train= 1.00
epoch: 600 , mse_ 0.439 , loss_anch 0.439 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.144 , loss_anch 0.144 tau-train= 1.00
epoch: 400 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.355 , loss_anch 0.355 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=6 | not-eval=0 | tau=-0.33 | n_kendall=12 | std(means)/mean(stds)=  0.59 | std(means)=3.03e+00 | mean(stds)=5.09e+00
tau-population=-0.87
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 36.528 , loss_anch 36.528 tau-train= 0.71
epoch: 400 , mse_ 13.094 , loss_anch 13.094 tau-train= 0.71
epoch: 600 , mse_ 6.533 , loss_anch 6.533 tau-train= 0.85
epoch: 800 , mse_ 18.664 , loss_anch 18.664 tau-train= 0.42
epoch: 1000 , mse_ 2.445 , loss_anch 2.445 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 2.133 , loss_anch 2.133 tau-train= 0.93
epoch: 400 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 16.572 , loss_anch 16.572 tau-train= 0.75
epoch: 400 , mse_ 5.019 , loss_anch 5.019 tau-train= 0.78
epoch: 600 , mse_ 0.601 , loss_anch 0.601 tau-train= 0.93
epoch: 800 , mse_ 0.033 , loss_anch 0.033 tau-train= 1.00
epoch: 1000 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 8.251 , loss_anch 8.251 tau-train= 0.96
epoch: 400 , mse_ 0.781 , loss_anch 0.781 tau-train= 0.96
epoch: 600 , mse_ 0.022 , loss_anch 0.022 tau-train= 0.96
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 1.446 , loss_anch 1.446 tau-train= 0.89
epoch: 400 , mse_ 0.012 , loss_anch 0.012 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=1 | not-eval=5 | tau= 0.97 | n_kendall=12 | std(means)/mean(stds)=  1.98 | std(means)=3.47e+02 | mean(stds)=1.75e+02
tau-population= 1.00
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 114.921 , loss_anch 114.921 tau-train= 0.71
epoch: 400 , mse_ 7.983 , loss_anch 7.983 tau-train= 0.71
epoch: 600 , mse_ 5.535 , loss_anch 5.535 tau-train= 0.85
epoch: 800 , mse_ 4.529 , loss_anch 4.529 tau-train= 0.89
epoch: 1000 , mse_ 3.61 , loss_anch 3.61 tau-train= 0.89

NN: 1
epoch: 200 , mse_ 4.27 , loss_anch 4.27 tau-train= 1.00
epoch: 400 , mse_ 0.48 , loss_anch 0.48 tau-train= 0.96
epoch: 600 , mse_ 0.031 , loss_anch 0.031 tau-train= 0.96
epoch: 800 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 8.028 , loss_anch 8.028 tau-train= 0.78
epoch: 400 , mse_ 4.906 , loss_anch 4.906 tau-train= 0.93
epoch: 600 , mse_ 4.225 , loss_anch 4.225 tau-train= 1.00
epoch: 800 , mse_ 3.464 , loss_anch 3.464 tau-train= 0.93
epoch: 1000 , mse_ 2.745 , loss_anch 2.745 tau-train= 0.89

NN: 3
epoch: 200 , mse_ 4.917 , loss_anch 4.917 tau-train= 1.00
epoch: 400 , mse_ 2.152 , loss_anch 2.152 tau-train= 1.00
epoch: 600 , mse_ 0.586 , loss_anch 0.586 tau-train= 0.96
epoch: 800 , mse_ 0.126 , loss_anch 0.126 tau-train= 1.00
epoch: 1000 , mse_ 0.012 , loss_anch 0.012 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 2.559 , loss_anch 2.559 tau-train= 0.96
epoch: 400 , mse_ 0.446 , loss_anch 0.446 tau-train= 0.96
epoch: 600 , mse_ 0.042 , loss_anch 0.042 tau-train= 1.00
epoch: 800 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=0.9636363636363636
tau-archive=0.9636363636363636
eval=1 | not-eval=5 | tau= 0.91 | n_kendall=12 | std(means)/mean(stds)=  0.86 | std(means)=6.57e+01 | mean(stds)=7.60e+01
tau-population= 0.87
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 22.571 , loss_anch 22.571 tau-train= 0.71
epoch: 400 , mse_ 1.919 , loss_anch 1.919 tau-train= 0.67
epoch: 600 , mse_ 0.642 , loss_anch 0.642 tau-train= 0.71
epoch: 800 , mse_ 0.382 , loss_anch 0.382 tau-train= 0.75
epoch: 1000 , mse_ 0.223 , loss_anch 0.223 tau-train= 0.82

NN: 1
epoch: 200 , mse_ 4.908 , loss_anch 4.908 tau-train= 0.93
epoch: 400 , mse_ 0.759 , loss_anch 0.759 tau-train= 0.96
epoch: 600 , mse_ 0.036 , loss_anch 0.036 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 58.401 , loss_anch 58.401 tau-train= 0.71
epoch: 400 , mse_ 16.025 , loss_anch 16.025 tau-train= 0.75
epoch: 600 , mse_ 10.347 , loss_anch 10.347 tau-train= 0.85
epoch: 800 , mse_ 7.128 , loss_anch 7.128 tau-train= 0.82
epoch: 1000 , mse_ 4.629 , loss_anch 4.629 tau-train= 0.82

NN: 3
epoch: 200 , mse_ 17.065 , loss_anch 17.065 tau-train= 1.00
epoch: 400 , mse_ 2.004 , loss_anch 2.004 tau-train= 0.96
epoch: 600 , mse_ 0.284 , loss_anch 0.284 tau-train= 1.00
epoch: 800 , mse_ 0.02 , loss_anch 0.02 tau-train= 1.00
epoch: 1000 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 7.768 , loss_anch 7.768 tau-train= 0.96
epoch: 400 , mse_ 0.957 , loss_anch 0.957 tau-train= 0.96
epoch: 600 , mse_ 0.04 , loss_anch 0.04 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=1 | not-eval=5 | tau= 0.97 | n_kendall=12 | std(means)/mean(stds)=  2.52 | std(means)=2.56e+02 | mean(stds)=1.02e+02
tau-population=-0.20
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 76.5 , loss_anch 76.5 tau-train= 0.64
epoch: 400 , mse_ 5.506 , loss_anch 5.506 tau-train= 0.64
epoch: 600 , mse_ 2.777 , loss_anch 2.777 tau-train= 0.78
epoch: 800 , mse_ 1.838 , loss_anch 1.838 tau-train= 0.75
epoch: 1000 , mse_ 1.146 , loss_anch 1.146 tau-train= 0.78

NN: 1
epoch: 200 , mse_ 2.669 , loss_anch 2.669 tau-train= 0.89
epoch: 400 , mse_ 2.79 , loss_anch 2.79 tau-train= 0.89
epoch: 600 , mse_ 1.335 , loss_anch 1.335 tau-train= 0.96
epoch: 800 , mse_ 0.985 , loss_anch 0.985 tau-train= 0.96
epoch: 1000 , mse_ 0.658 , loss_anch 0.658 tau-train= 0.93

NN: 2
epoch: 200 , mse_ 9.559 , loss_anch 9.559 tau-train= 0.56
epoch: 400 , mse_ 3.282 , loss_anch 3.282 tau-train= 0.85
epoch: 600 , mse_ 2.77 , loss_anch 2.77 tau-train= 0.93
epoch: 800 , mse_ 2.33 , loss_anch 2.33 tau-train= 0.96
epoch: 1000 , mse_ 1.934 , loss_anch 1.934 tau-train= 0.89

NN: 3
epoch: 200 , mse_ 4.638 , loss_anch 4.638 tau-train= 0.78
epoch: 400 , mse_ 3.004 , loss_anch 3.004 tau-train= 1.00
epoch: 600 , mse_ 1.853 , loss_anch 1.853 tau-train= 1.00
epoch: 800 , mse_ 0.728 , loss_anch 0.728 tau-train= 0.89
epoch: 1000 , mse_ 0.218 , loss_anch 0.218 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 3.133 , loss_anch 3.133 tau-train= 0.96
epoch: 400 , mse_ 1.745 , loss_anch 1.745 tau-train= 0.96
epoch: 600 , mse_ 0.652 , loss_anch 0.652 tau-train= 1.00
epoch: 800 , mse_ 0.171 , loss_anch 0.171 tau-train= 1.00
epoch: 1000 , mse_ 0.026 , loss_anch 0.026 tau-train= 1.00
tau-train-ens=0.8545454545454545
tau-archive=0.8545454545454545
eval=1 | not-eval=5 | tau= 0.88 | n_kendall=12 | std(means)/mean(stds)=  0.29 | std(means)=7.59e+01 | mean(stds)=2.61e+02
tau-population=-0.33
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 4.261 , loss_anch 4.261 tau-train= 0.78
epoch: 400 , mse_ 2.791 , loss_anch 2.791 tau-train= 0.71
epoch: 600 , mse_ 2.225 , loss_anch 2.225 tau-train= 0.78
epoch: 800 , mse_ 1.597 , loss_anch 1.597 tau-train= 0.96
epoch: 1000 , mse_ 1.789 , loss_anch 1.789 tau-train= 0.78

NN: 1
epoch: 200 , mse_ 5.745 , loss_anch 5.745 tau-train= 0.82
epoch: 400 , mse_ 4.056 , loss_anch 4.056 tau-train= 0.93
epoch: 600 , mse_ 2.965 , loss_anch 2.965 tau-train= 0.93
epoch: 800 , mse_ 1.979 , loss_anch 1.979 tau-train= 0.93
epoch: 1000 , mse_ 1.12 , loss_anch 1.12 tau-train= 0.96

NN: 2
epoch: 200 , mse_ 63.147 , loss_anch 63.147 tau-train= 0.53
epoch: 400 , mse_ 8.531 , loss_anch 8.531 tau-train= 0.78
epoch: 600 , mse_ 7.907 , loss_anch 7.907 tau-train= 0.89
epoch: 800 , mse_ 7.424 , loss_anch 7.424 tau-train= 0.93
epoch: 1000 , mse_ 6.852 , loss_anch 6.852 tau-train= 0.93

NN: 3
epoch: 200 , mse_ 4.666 , loss_anch 4.666 tau-train= 0.78
epoch: 400 , mse_ 1.849 , loss_anch 1.849 tau-train= 0.78
epoch: 600 , mse_ 0.669 , loss_anch 0.669 tau-train= 0.85
epoch: 800 , mse_ 0.136 , loss_anch 0.136 tau-train= 0.93
epoch: 1000 , mse_ 0.055 , loss_anch 0.055 tau-train= 0.96

NN: 4
epoch: 200 , mse_ 5.706 , loss_anch 5.706 tau-train= 0.89
epoch: 400 , mse_ 2.667 , loss_anch 2.667 tau-train= 0.93
epoch: 600 , mse_ 1.569 , loss_anch 1.569 tau-train= 0.93
epoch: 800 , mse_ 0.961 , loss_anch 0.961 tau-train= 0.93
epoch: 1000 , mse_ 0.542 , loss_anch 0.542 tau-train= 0.96
tau-train-ens=0.8909090909090909
tau-archive=0.8909090909090909
eval=6 | not-eval=0 | tau=-0.11 | n_kendall=12 | std(means)/mean(stds)=  1.01 | std(means)=3.04e+02 | mean(stds)=3.02e+02
tau-population=-0.07
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 1.547 , loss_anch 1.547 tau-train= 1.00
epoch: 400 , mse_ 0.229 , loss_anch 0.229 tau-train= 1.00
epoch: 600 , mse_ 0.051 , loss_anch 0.051 tau-train= 1.00
epoch: 800 , mse_ 0.012 , loss_anch 0.012 tau-train= 1.00
epoch: 1000 , mse_ 0.003 , loss_anch 0.003 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.283 , loss_anch 0.283 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 0.997 , loss_anch 0.997 tau-train= 1.00
epoch: 400 , mse_ 0.487 , loss_anch 0.487 tau-train= 1.00
epoch: 600 , mse_ 0.237 , loss_anch 0.237 tau-train= 1.00
epoch: 800 , mse_ 0.112 , loss_anch 0.112 tau-train= 1.00
epoch: 1000 , mse_ 0.053 , loss_anch 0.053 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.163 , loss_anch 0.163 tau-train= 1.00
epoch: 400 , mse_ 0.007 , loss_anch 0.007 tau-train= 1.00
epoch: 600 , mse_ 0.002 , loss_anch 0.002 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=1 | not-eval=5 | tau= 1.00 | n_kendall=12 | std(means)/mean(stds)=  2.49 | std(means)=1.84e+00 | mean(stds)=7.38e-01
tau-population= 1.00
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 8.298 , loss_anch 8.298 tau-train= 1.00
epoch: 400 , mse_ 2.856 , loss_anch 2.856 tau-train= 1.00
epoch: 600 , mse_ 0.831 , loss_anch 0.831 tau-train= 1.00
epoch: 800 , mse_ 0.234 , loss_anch 0.234 tau-train= 1.00
epoch: 1000 , mse_ 0.067 , loss_anch 0.067 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.234 , loss_anch 0.234 tau-train= 1.00
epoch: 400 , mse_ 0.049 , loss_anch 0.049 tau-train= 1.00
epoch: 600 , mse_ 0.029 , loss_anch 0.029 tau-train= 1.00
epoch: 800 , mse_ 0.017 , loss_anch 0.017 tau-train= 1.00
epoch: 1000 , mse_ 0.01 , loss_anch 0.01 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 3.746 , loss_anch 3.746 tau-train= 1.00
epoch: 400 , mse_ 0.127 , loss_anch 0.127 tau-train= 1.00
epoch: 600 , mse_ 0.018 , loss_anch 0.018 tau-train= 1.00
epoch: 800 , mse_ 0.031 , loss_anch 0.031 tau-train= 1.00
epoch: 1000 , mse_ 0.051 , loss_anch 0.051 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.343 , loss_anch 0.343 tau-train= 1.00
epoch: 400 , mse_ 0.039 , loss_anch 0.039 tau-train= 1.00
epoch: 600 , mse_ 0.025 , loss_anch 0.025 tau-train= 1.00
epoch: 800 , mse_ 0.017 , loss_anch 0.017 tau-train= 1.00
epoch: 1000 , mse_ 0.011 , loss_anch 0.011 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.001 , loss_anch 0.001 tau-train= 1.00
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=1 | not-eval=5 | tau= 1.00 | n_kendall=12 | std(means)/mean(stds)=  3.03 | std(means)=2.17e+00 | mean(stds)=7.15e-01
tau-population= 0.87
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 4.243 , loss_anch 4.243 tau-train= 1.00
epoch: 400 , mse_ 1.041 , loss_anch 1.041 tau-train= 1.00
epoch: 600 , mse_ 0.338 , loss_anch 0.338 tau-train= 1.00
epoch: 800 , mse_ 0.161 , loss_anch 0.161 tau-train= 1.00
epoch: 1000 , mse_ 0.1 , loss_anch 0.1 tau-train= 1.00

NN: 1
epoch: 200 , mse_ 0.18 , loss_anch 0.18 tau-train= 1.00
epoch: 400 , mse_ 0.048 , loss_anch 0.048 tau-train= 1.00
epoch: 600 , mse_ 0.026 , loss_anch 0.026 tau-train= 1.00
epoch: 800 , mse_ 0.022 , loss_anch 0.022 tau-train= 1.00
epoch: 1000 , mse_ 0.021 , loss_anch 0.021 tau-train= 1.00

NN: 2
epoch: 200 , mse_ 0.925 , loss_anch 0.925 tau-train= 1.00
epoch: 400 , mse_ 0.599 , loss_anch 0.599 tau-train= 1.00
epoch: 600 , mse_ 0.422 , loss_anch 0.422 tau-train= 1.00
epoch: 800 , mse_ 0.285 , loss_anch 0.285 tau-train= 1.00
epoch: 1000 , mse_ 0.183 , loss_anch 0.183 tau-train= 1.00

NN: 3
epoch: 200 , mse_ 0.158 , loss_anch 0.158 tau-train= 1.00
epoch: 400 , mse_ 0.05 , loss_anch 0.05 tau-train= 1.00
epoch: 600 , mse_ 0.036 , loss_anch 0.036 tau-train= 1.00
epoch: 800 , mse_ 0.025 , loss_anch 0.025 tau-train= 1.00
epoch: 1000 , mse_ 0.017 , loss_anch 0.017 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.096 , loss_anch 0.096 tau-train= 1.00
epoch: 400 , mse_ 0.071 , loss_anch 0.071 tau-train= 1.00
epoch: 600 , mse_ 0.065 , loss_anch 0.065 tau-train= 1.00
epoch: 800 , mse_ 0.058 , loss_anch 0.058 tau-train= 1.00
epoch: 1000 , mse_ 0.05 , loss_anch 0.05 tau-train= 1.00
tau-train-ens=1.0
tau-archive=1.0
eval=6 | not-eval=0 | tau= 0.56 | n_kendall=12 | std(means)/mean(stds)=  0.92 | std(means)=1.66e+00 | mean(stds)=1.80e+00
tau-population= 0.33
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 1.122 , loss_anch 1.122 tau-train= 0.38
epoch: 400 , mse_ 0.116 , loss_anch 0.116 tau-train= 0.42
epoch: 600 , mse_ 0.026 , loss_anch 0.026 tau-train= 0.49
epoch: 800 , mse_ 0.008 , loss_anch 0.008 tau-train= 0.56
epoch: 1000 , mse_ 0.003 , loss_anch 0.003 tau-train= 0.60

NN: 1
epoch: 200 , mse_ 0.035 , loss_anch 0.035 tau-train= 0.89
epoch: 400 , mse_ 0.031 , loss_anch 0.031 tau-train= 0.96
epoch: 600 , mse_ 0.027 , loss_anch 0.027 tau-train= 0.96
epoch: 800 , mse_ 0.022 , loss_anch 0.022 tau-train= 0.96
epoch: 1000 , mse_ 0.018 , loss_anch 0.018 tau-train= 0.96

NN: 2
epoch: 200 , mse_ 0.011 , loss_anch 0.011 tau-train= 0.56
epoch: 400 , mse_ 0.005 , loss_anch 0.005 tau-train= 0.71
epoch: 600 , mse_ 0.004 , loss_anch 0.004 tau-train= 0.82
epoch: 800 , mse_ 0.003 , loss_anch 0.003 tau-train= 0.85
epoch: 1000 , mse_ 0.003 , loss_anch 0.003 tau-train= 0.89

NN: 3
epoch: 200 , mse_ 0.009 , loss_anch 0.009 tau-train= 0.82
epoch: 400 , mse_ 0.009 , loss_anch 0.009 tau-train= 0.96
epoch: 600 , mse_ 0.008 , loss_anch 0.008 tau-train= 0.96
epoch: 800 , mse_ 0.008 , loss_anch 0.008 tau-train= 0.96
epoch: 1000 , mse_ 0.007 , loss_anch 0.007 tau-train= 0.96

NN: 4
epoch: 200 , mse_ 0.001 , loss_anch 0.001 tau-train= 0.75
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.85
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.85
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.85
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.85
tau-train-ens=0.9272727272727274
tau-archive=0.9272727272727274
eval=6 | not-eval=0 | tau=-0.47 | n_kendall=12 | std(means)/mean(stds)=  2.15 | std(means)=1.40e+03 | mean(stds)=6.50e+02
tau-population=-0.87
subset-idx-size=12

NN: 0
epoch: 200 , mse_ 10.921 , loss_anch 10.921 tau-train= 0.13
epoch: 400 , mse_ 1.771 , loss_anch 1.771 tau-train= 0.16
epoch: 600 , mse_ 0.42 , loss_anch 0.42 tau-train= 0.13
epoch: 800 , mse_ 0.181 , loss_anch 0.181 tau-train= 0.16
epoch: 1000 , mse_ 0.144 , loss_anch 0.144 tau-train= 0.16

NN: 1
epoch: 200 , mse_ 0.411 , loss_anch 0.411 tau-train= 0.13
epoch: 400 , mse_ 0.117 , loss_anch 0.117 tau-train= 0.16
epoch: 600 , mse_ 0.049 , loss_anch 0.049 tau-train= 0.42
epoch: 800 , mse_ 0.016 , loss_anch 0.016 tau-train= 0.64
epoch: 1000 , mse_ 0.004 , loss_anch 0.004 tau-train= 0.67

NN: 2
epoch: 200 , mse_ 1.406 , loss_anch 1.406 tau-train= 0.24
epoch: 400 , mse_ 0.088 , loss_anch 0.088 tau-train= 0.20
epoch: 600 , mse_ 0.016 , loss_anch 0.016 tau-train= 0.35
epoch: 800 , mse_ 0.005 , loss_anch 0.005 tau-train= 0.53
epoch: 1000 , mse_ 0.002 , loss_anch 0.002 tau-train= 0.64

NN: 3
epoch: 200 , mse_ 0.613 , loss_anch 0.613 tau-train= 0.20
epoch: 400 , mse_ 0.043 , loss_anch 0.043 tau-train= 0.16
epoch: 600 , mse_ 0.003 , loss_anch 0.003 tau-train= 0.71
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.89
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00

NN: 4
epoch: 200 , mse_ 0.068 , loss_anch 0.068 tau-train= 0.27
epoch: 400 , mse_ 0.0 , loss_anch 0.0 tau-train= 0.93
epoch: 600 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 800 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
epoch: 1000 , mse_ 0.0 , loss_anch 0.0 tau-train= 1.00
> /home/jarda/Desktop/thesis/nncmaes/code/nncmaes.py(1080)__call__()
-> print(f"tau-train-ens={_tau}")
(Pdb) 979  	    def __call__(
980  	        self,
981  	        *,
982  	        x_train: NDArray[np.float64],
983  	        y_train: NDArray[np.float64],
984  	        x_test: NDArray[np.float64],
985  	        weights: NDArray[np.float64],
986  	    ):
987  	        data_noise = self.__data_noise
988  	        """Taken form `RAFs <https://github.com/YanasGH/RAFs/blob/6a0ec46a7d9cd830e7d8e74358643aee1f65323d/main_experiments/rafs.py#L94-L157>`_"""
989  	        X_train, y_train, X_val = x_train, y_train, x_test
990  	
991  	        n = X_train.shape[0]
992  	        x_dim = X_train.shape[1]
993  	        y_dim = y_train.shape[1]
994  	        if __debug__:
995  	            _max_model_size = max(x_test.shape[0], x_dim * (x_dim + 3) + 2)  # for kendall only
996  	            _n_kendall_archive = _max_model_size - 1
997  	
998  	        n_ensembles = 5
999  	        hidden_size = 100
1000 	        init_stddev_1_w = np.sqrt(10)
1001 	        init_stddev_1_b = init_stddev_1_w  # set these equal
1002 	        init_stddev_2_w = 1.0 / np.sqrt(hidden_size)  # normal scaling
1003 	        lambda_anchor = data_noise / (
1004 	            np.array([init_stddev_1_w, init_stddev_1_b, init_stddev_2_w]) ** 2
1005 	        )
1006 	
1007 	        n_epochs = self.__epochs
1008 	        learning_rate = 0.01
1009 	
1010 	        NNs = []
1011 	        y_prior = []
1012 	        tf.reset_default_graph()
1013 	        sess = tf.Session()
1014 	
1015 	        # loop to initialise all ensemble members, get priors
1016 	        for ens in range(0, n_ensembles):
1017 	            NNs.append(
1018 	                NN(
1019 	                    x_dim,
1020 	                    y_dim,
1021 	                    hidden_size,
1022 	                    init_stddev_1_w,
1023 	                    init_stddev_1_b,
1024 	                    init_stddev_2_w,
1025 	                    n,
1026 	                    learning_rate,
1027 	                    ens,
1028 	                )
1029 	            )
1030 	
1031 	            # initialise only unitialized variables - stops overwriting ensembles already created
1032 	            global_vars = tf.global_variables()
1033 	            is_not_initialized = sess.run(
1034 	                [tf.is_variable_initialized(var) for var in global_vars]
1035 	            )
1036 	            not_initialized_vars = [
1037 	                v for (v, f) in zip(global_vars, is_not_initialized) if not f
1038 	            ]
1039 	            if len(not_initialized_vars):
1040 	                sess.run(tf.variables_initializer(not_initialized_vars))
1041 	
1042 	            # do regularisation now that we've created initialisations
1043 	            NNs[ens].anchor(
1044 	                sess, lambda_anchor
1045 	            )  # Do that if you want to minimize the anchored loss
1046 	
1047 	            # save their priors
1048 	            y_prior.append(NNs[ens].predict(X_val, sess))
1049 	
1050 	        for ens in range(0, n_ensembles):
1051 	            feed_b = {}
1052 	            feed_b[NNs[ens].inputs] = X_train
1053 	            feed_b[NNs[ens].y_target] = y_train
1054 	            if __debug__ and self.__debug:
1055 	                print("\nNN:", ens)
1056 	
1057 	            ep_ = 0
1058 	            while ep_ < n_epochs:
1059 	                ep_ += 1
1060 	                blank = sess.run(NNs[ens].optimizer, feed_dict=feed_b)  # noqa: F841
1061 	                if ep_ % (n_epochs / 5) == 0:
1062 	                    loss_mse = sess.run(NNs[ens].mse_, feed_dict=feed_b)
1063 	                    loss_anch = sess.run(NNs[ens].loss_, feed_dict=feed_b)
1064 	                    if __debug__ and self.__debug:
1065 	                        print(
1066 	                            "epoch:",
1067 	                            ep_,
1068 	                            ", mse_",
1069 	                            np.round(loss_mse * 1e3, 3),
1070 	                            ", loss_anch",
1071 	                            np.round(loss_anch * 1e3, 3),
1072 	                            "tau-train={:>5.2f}".format(kendalltau(y_train[-_n_kendall_archive:], np.array(NNs[ens].predict(X_train[-_n_kendall_archive:], sess))).statistic),  # pyright: ignore [reportOperatorIssue,reportPossiblyUnboundVariable]
1073 	                            )
1074 	                    # the anchored loss is minimized, but it's useful to keep an eye on mse too
1075 	
1076 	        if __debug__ and self.__debug:
1077 	            _tau = kendalltau(y_train[-_n_kendall_archive:], np.mean(np.array([nn.predict(X_train[-_n_kendall_archive:], sess) for nn in NNs]), axis=0)).statistic  # pyright: ignore [reportOperatorIssue,reportPossiblyUnboundVariable]
1078 	            if _tau < 0.7:
1079 	                breakpoint()
1080 ->	            print(f"tau-train-ens={_tau}")
1081 	
1082 	        def raf(features):
1083 	            y_pred = np.array([nn.predict(features, sess) for nn in NNs])
1084 	            return Prediction(
1085 	                np.mean(y_pred, axis=0),
1086 	                np.sqrt(np.square(np.std(y_pred, axis=0, ddof=1)) + data_noise),
1087 	            )
1088 	
1089 	        return raf
(Pdb) array([[ 4.68720714],
       [-0.24438323],
       [-0.24505587],
       [-0.24560126],
       [-0.24688744],
       [-0.24772504],
       [ 1.19644514],
       [-0.24600368],
       [-0.24825775],
       [-0.2487114 ],
       [-0.24914238],
       [-0.24918279]])
(Pdb) array([[ 4.68507931],
       [-0.25584101],
       [-0.25542678],
       [-0.25204993],
       [-0.25609155],
       [-0.25205207],
       [ 1.18906719],
       [-0.25595311],
       [-0.23911039],
       [-0.27833353],
       [-0.25777962],
       [-0.23690613]])
(Pdb) array([[ 0.00212783],
       [ 0.01145779],
       [ 0.01037091],
       [ 0.00644867],
       [ 0.0092041 ],
       [ 0.00432703],
       [ 0.00737795],
       [ 0.00994943],
       [-0.00914736],
       [ 0.02962213],
       [ 0.00863724],
       [-0.01227666]])
(Pdb) 